# Система Быстрых Платежей (SBP) - Демонстрационное Приложение

Это демонстрационное приложение эмулирует основные функции Системы Быстрых Платежей. Оно состоит из нескольких микросервисов, взаимодействующих друг с другом через REST API и JMS (ActiveMQ).

## Составные части (Микросервисы)

*   **Transfer Service (localhost:8080):** Управляет логикой инициирования и подтверждения переводов.
*   **Account Service (localhost:8081):** Управляет счетами пользователей, резервированием и списанием средств (взаимодействие только через JMS).
*   **Notification Service (localhost:8082):** Эмулирует отправку уведомлений и кодов подтверждения (предоставляет UI для отображения кодов).
*   **SBP Adapter Service (localhost:8083):** Мок-сервис, эмулирующий взаимодействие с реальной СБП для получения информации о банках и обработки переводов.
*   **PostgreSQL (localhost:5432):** База данных для хранения информации о переводах (transfer-service) и счетах (account-service).
*   **ActiveMQ (localhost:8161):** Брокер сообщений для асинхронного взаимодействия между сервисами. (Веб-консоль доступна по адресу http://localhost:8161/, логин/пароль по умолчанию: admin/admin, если не изменены в `docker-compose.yml`).

## Предварительные требования

*   [Docker](https://www.docker.com/get-started)
*   [Docker Compose](https://docs.docker.com/compose/install/)

## Запуск и Остановка

### 1. Сборка и запуск всех сервисов

Для сборки Docker-образов и запуска всех сервисов в фоновом режиме выполните команду в корневой директории проекта:

```bash
docker-compose up --build -d
```

После выполнения этой команды все сервисы будут запущены, и вы сможете взаимодействовать с ними через указанные порты.

### 2. Остановка и удаление контейнеров

Для остановки и удаления всех контейнеров, созданных `docker-compose`, выполните:

```bash
docker-compose down
```

Если вы также хотите удалить тома (volumes), в которых PostgreSQL хранит данные, используйте:

```bash
docker-compose down -v
```

## Важное замечание о сборке под ARM64

Текущая конфигурация Dockerfile'ов для сервисов (`transfer-service`, `account-service`, `notification-service`, `sbp-adapter-service`) использует базовые образы, предназначенные для архитектуры **ARM64** (например, `arm64v8/maven` и `arm64v8/openjdk`).

Пример из Dockerfile для `transfer-service` (аналогично для других):

```dockerfile
# Этап 1: Сборка Maven-проекта
FROM arm64v8/maven:3.9-eclipse-temurin-17 AS builder

# ... (сборка common-dto и самого сервиса) ...

# Этап 2: Создание финального образа
FROM arm64v8/openjdk:17-jdk-slim AS final
# ... (копирование jar и запуск) ...
```

Если вы запускаете это на машине с архитектурой x86_64, вам потребуется изменить базовые образы в Dockerfile'ах на их x86_64 эквиваленты (например, `maven:3.9-eclipse-temurin-17` и `openjdk:17-jdk-slim`).

## Helper для проверки БД

Вы можете подключиться к базе данных PostgreSQL, запущенной в Docker-контейнере, для просмотра таблиц, выполнения запросов и т.д.

1.  `docker ps`

2. `docker exec -it имя_контейнера_postgres bash`

3. `psql`



### P.S

Для конфигурации приложения изменяйте docker-compose под ваши нужды